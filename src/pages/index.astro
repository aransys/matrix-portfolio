---
import Layout from '../layouts/Layout.astro';
import Navigation from '../components/Navigation.astro';
import Hero from '../components/Hero.astro';
import About from '../components/About.astro';
import Services from '../components/Services.astro';
import Projects from '../components/Projects.astro';
import Skills from '../components/Skills.astro';
import Contact from '../components/Contact.astro';
import ThemeSwitcher from '../components/ThemeSwitcher.astro';
import ScrollToTop from '../components/ScrollToTop.astro';
---

<Layout title="Aurimas Ransys - Full Stack Developer">
  <div class="matrix-bg" id="matrix-bg"></div>
  
  <Navigation />
  <Hero />
  <About />
  <Services />
  <Projects />
  <Skills />
  <Contact />
  <ThemeSwitcher />
  <ScrollToTop />
  
  <script>
    
    function createMatrixRain() {
      const container = document.getElementById('matrix-bg');
      if (!container) return;
      
      const columns = Math.floor(window.innerWidth / 20);
      const characters = '01アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲン';
      
      container.innerHTML = '';
      
      for (let i = 0; i < columns; i++) {
        const column = document.createElement('div');
        column.className = 'matrix-column';
        column.style.left = i * 20 + 'px';
        column.style.animationDuration = Math.random() * 3 + 2 + 's';
        column.style.animationDelay = Math.random() * 2 + 's';
        
        let text = '';
        for (let j = 0; j < 20; j++) {
          text += characters.charAt(Math.floor(Math.random() * characters.length)) + '<br>';
        }
        column.innerHTML = text;
        
        container.appendChild(column);
      }
    }
    
    
    
    
    function typeWriter(element: HTMLElement | null, text: string, speed = 100) {
      if (!element) return;
      let i = 0;
      element.innerHTML = '';
      
      function type() {
        if (i < text.length) {
          if (element) {
            element.innerHTML += text.charAt(i);
          }
          i++;
          setTimeout(type, speed);
        }
      }
      type();
    }
    
    function handleScrollAnimations() {
      const elements = document.querySelectorAll('.fade-in');
      
      elements.forEach(element => {
        const elementTop = element.getBoundingClientRect().top;
        const elementVisible = 150;
        
        if (elementTop < window.innerHeight - elementVisible) {
          element.classList.add('visible');
        }
      });
    }
    
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const href = this.getAttribute('href');
        if (href) {
          const target = document.querySelector(href);
          if (target) {
            target.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        }
      });
    });
    
    window.addEventListener('load', () => {
      createMatrixRain();
      handleScrollAnimations();
      
      const subtitle = document.querySelector('.hero-subtitle');
      if (subtitle) {
        typeWriter(subtitle as HTMLElement, 'Full Stack Developer |');
      }
    });
    
    window.addEventListener('scroll', handleScrollAnimations);
    window.addEventListener('resize', () => {
      createMatrixRain();
    });
    
    // Easter egg: Terminal prompt click
    let terminalClickCount = 0;
    let terminalClickTimer: number;
    const matrixQuotes = [
      "Wake up, Neo...",
      "Follow the white rabbit",
      "There is no spoon",
      "The Matrix has you",
      "Welcome to the real world",
      "What is the Matrix?",
      "Red pill or blue pill?",
      "Free your mind"
    ];
    
    const terminalPrompt = document.getElementById('terminal-prompt');
    if (terminalPrompt) {
      terminalPrompt.addEventListener('click', () => {
        terminalClickCount++;
        clearTimeout(terminalClickTimer);
        
        if (terminalClickCount === 3) {
          const randomQuote = matrixQuotes[Math.floor(Math.random() * matrixQuotes.length)];
          terminalPrompt.textContent = `user@matrix:~$ ${randomQuote}`;
          terminalPrompt.classList.add('easter-egg');
          terminalClickCount = 0;
        }
        
        terminalClickTimer = window.setTimeout(() => {
          terminalClickCount = 0;
        }, 1000);
      });
    }
    
    // Easter egg: Konami code
    let konamiCode: string[] = [];
    const sequence = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'KeyB', 'KeyA'];
    
    document.addEventListener('keydown', (e) => {
      konamiCode.push(e.code);
      if (konamiCode.length > sequence.length) {
        konamiCode.shift();
      }
      
      if (konamiCode.join(',') === sequence.join(',')) {
        document.body.style.filter = 'hue-rotate(180deg)';
        setTimeout(() => {
          alert('Welcome to the real world, Neo.');
          document.body.style.filter = 'none';
        }, 1000);
        konamiCode = [];
      }
    });
  </script>
</Layout>
